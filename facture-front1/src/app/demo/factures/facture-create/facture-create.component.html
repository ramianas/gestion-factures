<!-- Ajoutez cette section dans votre template HTML juste après la div loading-container -->
<app-card cardTitle="Création Facture" [showContent]="true">
  <p>Contenu test de la carte</p>
</app-card>

<div class="facture-create-container">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Chargement...</span>
      </div>
      <p class="mt-3">Chargement des données...</p>
    </div>
  </div>

  <!-- ✅ AJOUT: Error State (Optionnel - pour informer l'utilisateur) -->
  <div *ngIf="hasError && !isLoading" class="alert alert-warning alert-dismissible mb-4" role="alert">
    <div class="d-flex align-items-center">
      <i class="fas fa-exclamation-triangle me-3"></i>
      <div class="flex-grow-1">
        <strong>Information :</strong> {{ errorMessage }}
        <br>
        <small>Le formulaire fonctionne avec des données par défaut.</small>
      </div>
      <button type="button" class="btn btn-sm btn-outline-warning ms-2" (click)="retryLoadDonnees()">
        <i class="fas fa-redo me-1"></i>
        Réessayer
      </button>
    </div>
  </div>

  <!-- ✅ MODIFICATION: Main Content s'affiche maintenant même en cas d'erreur -->
  <div *ngIf="!isLoading" class="main-content">

    <!-- ✅ AJOUT: Bouton de debug (à supprimer en production) -->
    <div class="debug-panel mb-3" style="background: #f8f9fa; padding: 10px; border-radius: 8px; border: 1px dashed #dee2e6;">
      <small class="text-muted">
        <strong>Debug:</strong>
        V1: {{ validateursV1.length }},
        V2: {{ validateursV2.length }},
        Trésoriers: {{ tresoriers.length }}
        <button class="btn btn-sm btn-outline-secondary ms-2" (click)="logCurrentState()">
          <i class="fas fa-bug"></i> Log État
        </button>
      </small>
    </div>

    <!-- Le reste de votre template reste identique... -->
    <!-- Page Header -->
    <div class="page-header">
      <!-- ... votre contenu existant ... -->
    </div>

    <!-- Formulaire -->
    <form #factureForm="ngForm" (ngSubmit)="onSubmit()" novalidate>
      <!-- ... toutes vos sections existantes ... -->
    </form>

  </div>
</div>
